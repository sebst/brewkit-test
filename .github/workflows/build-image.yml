- name: Build image from Dockerfile and push it to ghcr
- on: push
  jobs:
    build:
      runs-on: ubuntu-latest
      steps:
        - name: Checkout repository
          uses: actions/checkout@v2
        - name: Build image
          run: docker build -t ghcr.io/${{ github.repository }}/my-image:latest .
        - name: Login to ghcr
          run: echo "${{ secrets.GITHUB_TOKEN }}" | docker login ghcr.io -u ${{ github.actor }} --password-stdin
        - name: Push image
          run: docker push ghcr.io/${{ github.repository }}/my-image:latest